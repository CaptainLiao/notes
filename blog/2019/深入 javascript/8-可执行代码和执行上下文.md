[ECMA 8.executable-code-and-execution-contexts](https://www.ecma-international.org/ecma-262/6.0/#sec-executable-code-and-execution-contexts)

### 术语
#### Record 和 field
ES6 规格将键值对（key-value map）的数据结构称为 Record，其中的每一组键值对称为 field。这就是说，一个 Record 由多个 field 组成，而每个 field 都包含一个键名（key）和一个键值（value）。

为了方便理解，我们可以将一个 Record 看做一个对象（{}）。

#### identifier binding
标识符绑定，将一个标识符和对应的值（数字、函数、对象等）绑定在一起。一个标识符不仅可以被绑定，也可以被解除绑定。如果一个标识符与一个对象绑定在一起，它便引用了这个对象，通过这个标识符就可以去访问和修改那个对象。

在 javascript 中，标识符绑定是按值传递的。

#### identifier resolver
标识符解析，指在运行的执行上下文中的词法环境里，通过标识符获得其对应绑定的过程。这一过程和原型链查找类似。

#### closure
闭包是一个组合，由代码块和代码块创建时所在的词法环境组成。

在 es6 中，所有函数都是闭包。[why?](https://tc39.es/ecma262/#sec-function-definitions-runtime-semantics-evaluation)


### 8.1 Lexical Environments
词法环境，又叫做静态词法作用域。作用域是以前的称呼，ES5 以后统称为环境。

词法环境用来定义标识符与变量/函数值之间的关联关系，所以，我们才能解释标识符在表达式中的行为和意义。这个关联在程序解析阶段（parsing stage）确定。

一般地，我们将标识符和值的关联称为绑定。

词法环境和 ECMA 代码中指定的语法结构相关（如FunctionDeclaration, a BlockStatement, or a Catch clause of a TryStatement），每当这些代码执行时，就会创建一个新的词法环境。

一个 Environment Record 持有在当前词法环境中创建的标识符绑定。

#### 8.1.1 Environment Records
````ts
class abstract EnvironmentRecords {
  public abstract Boolean HasBinding(N);
  public abstract EnvironmentRecord CreateMutableBinding(N, D);
  public abstract EnvironmentRecord CreateImmutableBinding(N, S);
  public abstract void InitializeBinding(N,V);
  public abstract Boolean SetMutableBinding(N,V, S);
  public abstract Boolean GetBindingValue(N,S);
  public abstract Boolean DeleteBinding(N);
  public abstract Boolean HasThisBinding();
  public abstract Boolean HasSuperBinding();
  public abstract Boolean WithBaseObject();
}

class DeclarativeEnvironmentRecords extends EnvironmentRecords {}

class ObjectEnvironmentRecords extends EnvironmentRecords {}

class GlobalEnvironmentRecords extends EnvironmentRecords {}

class FunctionEnvironmentRecords extends DeclarativeEnvironmentRecords {}

class ModuleEnvironmentRecords extends DeclarativeEnvironmentRecords {}

````
#### Declarative Environment Records
每个声明式环境记录都与ECMAScript代码的范围相关联。一个声明式环境记录绑定着一系列在它的范围内声明的标识符，即它包含在该范围内的 var，cont，let，class，module，import 和函数声明。


#### Object Environment Records
对象式环境记录项用来定义那些将标识符与某些对象属性相绑定的ES语法元素，例如with语句、全局上下文。对象式环境记录项是通过一个简单对象的形式来存储这些变量或函数标识符，这是一种低效率方式。

譬如，每次执行with语句，就会创建一个带有对象式环境记录的新词法环境。当前运行上下文环境被设置为这个新创建环境的外部环境。

因为对象式环境记录项的效率较低，在ES5的严格模式下with语句已经被移除了。

规范中的绑定对象其实是真实对象（例如全局对象）的一种反射，但并非所有原始对象的属性都会作为绑定对象的属性。例如，不是标识符的属性名称不包括在绑定对象中，这是非常合乎逻辑的，因为我们本来就不能像普通变量那样在代码中去访问。
````
// global properties
this['a'] = 10; // 包含在绑定对象中
this['hello world'] = 20; //不包含
 
console.log(a); // 10, can refer
console.log(hello world); // cannot, syntax error
````


[CMA-262-5 词法环境:通用理论（三）--- 标识符绑定]https://blog.csdn.net/szengtal/article/details/78722559
[ecma262](https://tc39.es/ecma262/)